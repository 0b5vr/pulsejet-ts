/*! (c) 2021 FMS_Cat - https://github.com/FMS-Cat/pulsejet-ts/blob/master/LICENSE */
!function(t,o){"object"==typeof exports&&"undefined"!=typeof module?o(exports):"function"==typeof define&&define.amd?define(["exports"],o):o((t="undefined"!=typeof globalThis?globalThis:t||self).PULSEJET={})}(this,(function(t){"use strict";const o=1024,e=2048,n=256;var r;t.WindowMode=void 0,(r=t.WindowMode||(t.WindowMode={}))[r.Long=0]="Long",r[r.Short=1]="Short",r[r.Start=2]="Start",r[r.Stop=3]="Stop";const i=[8,8,8,8,8,8,8,8,16,16,24,32,32,40,48,64,80,120,144,176];function s(t,o){const e=Math.sin(Math.PI/o*t);return Math.sin(Math.PI/2*e*e)}function f(o,e,r){const i=o+.5;if(r===t.WindowMode.Start){const t=1472;if(o>=t+128)return 0;if(o>=t)return 1-s(i-t,n);if(o>=1024)return 1}else if(r===t.WindowMode.Stop){const t=448;if(o<t)return 0;if(o<t+128)return s(i-t,n);if(o<1024)return 1}return s(i,e)}t.bandToNumBins=i,t.codecVersionMajor=0,t.codecVersionMinor=1,t.decode=function(r){const s=new DataView(r.buffer,r.byteOffset,r.byteLength);let c=0;c+=8;let a=s.getUint16(c,!0);c+=2;const d=a*o,l=new Float32Array(d);a++;let u=c;c+=a;let w=c;c+=856*a;const h=new Float32Array(d+2048),M=new Uint8Array(20);for(let d=0;d<a;d++){const a=r[u++];let l=1,S=0,p=e;a===t.WindowMode.Short&&(l=8,S=448,p=n);for(let t=0;t<l;t++){const e=new Float32Array(o);let n=0;for(let t=0;t<20;t++){const o=i[t]/l;let f=0;for(let t=0;t<o;t++){const o=s.getInt8(w++);o&&f++;const r=o;e[n+t]=r}const a=f/o,d=.1;if(a<d){const t=(d-a)/d,r=t*t;for(let t=0;t<o;t++){const o=2*Math.random()-1;e[n+t]+=o*r}}const u=r[c++],h=M[t]+u&255;M[t]=h;const S=Math.pow(2,h/64*40-20)*o;let p=1e-27;for(let t=0;t<o;t++){const o=e[n+t];p+=o*o}p=Math.sqrt(p);const y=S/p;for(let t=0;t<o;t++)e[n+t]*=y;n+=o}const u=d*o,y=S+t*p/2;for(let t=0;t<p;t++){const o=t+.5;let n=0;for(let t=0;t<p>>1;t++)e[t]&&(n+=2/(p>>1)*e[t]*Math.cos(Math.PI/(p>>1)*(o+(p>>2))*(t+.5)));const r=f(t,p,a);h[u+y+t]+=n*r}}}return l.set(new Float32Array(h.buffer,o,d)),l},t.frameSize=o,t.longWindowSize=e,t.mdctWindow=f,t.numBands=20,t.numShortWindowsPerFrame=8,t.numTotalBins=856,t.sampleTag="PLSJ",t.shortWindowSize=n,t.vorbisWindow=s,Object.defineProperty(t,"__esModule",{value:!0})}));
